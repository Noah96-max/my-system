<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>نظام الارتقاء الذاتي | المزامنة السحابية</title>
  <style>
    /* واجهتك المفضلة */
    body { background: linear-gradient(to bottom right, #000428, #004e92); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; direction: rtl; text-align: center; }
    .container { padding: 20px; }
    .level-text { font-size: 3.5em; font-weight: bold; color: #00f9ff; text-shadow: 0 0 20px #00f9ff; }
    .grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; padding: 20px; }
    .category { background: rgba(0, 0, 0, 0.6); border: 2px solid #00f9ff; border-radius: 15px; padding: 20px; min-width: 180px; }
    .stat-rank { font-size: 2em; color: #00f9ff; font-weight: bold; }
    .btn { padding: 10px; border: none; border-radius: 5px; background: #00f9ff; cursor: pointer; margin: 5px; font-weight: bold; }
    .sync-text { font-size: 0.8em; color: #00ff88; margin-bottom: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <div id="sync-status" class="sync-text">جاري الاتصال بالسحابة...</div>
    <div class="level-text">LEVEL: <span id="lvl">1</span></div>
    <div style="font-size: 1.2em; margin-bottom: 20px;">الرتبة العامة: <span id="rank">F</span></div>

    <div class="grid" id="stats-container"></div>
  </div>

  <script>
    // ضع رابط Firebase الخاص بك هنا (الذي ينتهي بـ .firebaseio.com)
    const DB_URL = "ضع_رابط_قاعدة_بياناتك_هنا"; 

    const properties = [
      { key: "str", name: "القوة" }, { key: "agi", name: "الرشاقة" },
      { key: "vit", name: "الحيوية" }, { key: "int", name: "الذكاء" },
      { key: "per", name: "الإدراك" }
    ];

    async function load() {
      try {
        const res = await fetch(`${DB_URL}/data.json`);
        const cloudData = await res.json();
        if(cloudData) {
          Object.keys(cloudData).forEach(k => localStorage.setItem(k, cloudData[k]));
          document.getElementById('sync-status').textContent = "متصل بالسحابة ✓";
        }
        render();
      } catch(e) { document.getElementById('sync-status').textContent = "وضع الأوفلاين"; render(); }
    }

    async function save(key, val) {
      localStorage.setItem(key, val);
      render();
      await fetch(`${DB_URL}/data/${key}.json`, { method: 'PUT', body: JSON.stringify(val) });
    }

    function render() {
      const container = document.getElementById('stats-container');
      container.innerHTML = '';
      let total = 0;
      properties.forEach(p => {
        const val = parseInt(localStorage.getItem(p.key)) || 0;
        total += val;
        container.innerHTML += `
          <div class="category">
            <div>${p.name}</div>
            <div class="stat-rank">${val}</div>
            <button class="btn" onclick="updateStat('${p.key}', 1)">+</button>
            <button class="btn" onclick="updateStat('${p.key}', -1)">-</button>
          </div>
        `;
      });
      document.getElementById('lvl').textContent = Math.floor(total / 10) + 1;
    }

    function updateStat(k, a) {
      let v = (parseInt(localStorage.getItem(k)) || 0) + a;
      save(k, Math.max(0, v));
    }

    window.onload = load;
  </script>
</body>
</html>
